<h2 style="text-align: center; margin-bottom: 30px;">
  Welcome, <%= @user_name %>
</h2>
<h3 style="text-align: center; margin-bottom: 20px;">
  All Services
</h3>

<div style="text-align: center; margin-bottom: 20px;">
  <%= form_with url: services_path, method: :get, local: true do %>

    <!-- Search bar -->
    <%= text_field_tag :search, params[:search], placeholder: "Search services...", 
        class: "form-control", 
        style: "width: 200px; display: inline-block; margin-right: 10px;" %>

    <br><br>
  
    <%= select_tag :category,
      options_for_select(
        ['All'] + Service.available_categories,
        params[:category] || 'All'
      ),
      id: "category",
      class: "form-control",
      style: "width: 200px; display: inline-block; margin-right: 10px;",
      onchange: "this.form.submit();" %>


    <%= select_tag :price_sort,
        options_for_select([['Sort by Price', ''], ['Price: Low → High', 'asc'], ['Price: High → Low', 'desc']], params[:price_sort]),
        class: "form-control",
        style: "width: 200px; display: inline-block;",
        onchange: "this.form.submit();" %>

    <!-- Hidden submit button so tests can submit the form -->
    <%= submit_tag "Filter", style: "display:none;" %>

  <% end %>
</div>


<div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-bottom: 30px;">
  <% @services.each do |s| %>
    <div style="
      background: #fffa9e;
      width: 190px; height: 190px;
      padding: 10px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.18);
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      text-align: center;
      font-family: Arial, sans-serif;">
      <h4 style="margin: 0 0 8px 0;"><%= link_to s.title, service_path(s), style: 'text-decoration: none; color: #222;' %></h4>
      <p style="margin: 0 0 8px 0;"><%= number_to_currency(s.price) %></p>
      <small>
  by
  <% vendor = @vendors_by_name[s.vendor_name] %>
  <% if vendor %>
   <%= link_to s.vendor_name,
    useraccount_path(vendor.id),
    style: 'text-decoration: underline; color: #222;' %>

  <% else %>
    <%= s.vendor_name %>
  <% end %>
</small>

      <small><strong>Category:</strong> <%= s.category.presence || "Uncategorized" %></small>
    </div>
  <% end %>
</div>

<div style="text-align: center; margin-top: 20px;"> <%= link_to 'Create New Service', new_service_path,style: ' padding: 10px 25px; font-size: 16px; background-color: #cfe8f3; color: #000; text-decoration: none; border-radius: 6px; display: inline-block; '%> </div>